{"ast":null,"code":"import _objectSpread from\"C:/Users/ashwi/OneDrive/Desktop/LightRiver UI/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef}from'react';import{ScrollArea}from'../ui/scroll-area';import{MessageBubble}from'./MessageBubble';import{ChatInput}from'./ChatInput';import{apiService}from'../../services/api';import{v4 as uuidv4}from'uuid';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const ChatInterface=_ref=>{let{conversation,onConversationUpdate,userId,sessionId}=_ref;const[messages,setMessages]=useState((conversation===null||conversation===void 0?void 0:conversation.messages)||[]);const[isLoading,setIsLoading]=useState(false);const[typingMessage,setTypingMessage]=useState(null);const scrollAreaRef=useRef(null);const messagesEndRef=useRef(null);useEffect(()=>{if(conversation){setMessages(conversation.messages);}else{setMessages([]);}},[conversation]);useEffect(()=>{scrollToBottom();},[messages,typingMessage]);const scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});};const handleSendMessage=async content=>{if(!content.trim()||isLoading)return;const userMessage={id:uuidv4(),content,role:'user',timestamp:new Date()};setMessages(prev=>[...prev,userMessage]);setIsLoading(true);// Show typing indicator\nconst typingMsg={id:'typing',content:'',role:'assistant',timestamp:new Date()};setTypingMessage(typingMsg);try{console.log('Sending query to Wexa co-worker:',content);const queryRequest={user_id:userId,session_id:sessionId,query:content};const response=await apiService.sendQuery(queryRequest);console.log('Received response from Wexa co-worker:',response);const assistantMessage={id:uuidv4(),content:response.answer,role:'assistant',timestamp:new Date(),sources:response.sources};setTypingMessage(null);setMessages(prev=>[...prev,assistantMessage]);// Update conversation\nif(conversation){const updatedConversation=_objectSpread(_objectSpread({},conversation),{},{messages:[...conversation.messages,userMessage,assistantMessage],updated_at:new Date()});onConversationUpdate(updatedConversation);}}catch(error){console.error('Error sending message:',error);setTypingMessage(null);const errorMessage={id:uuidv4(),content:'Sorry, I encountered an error while processing your request. Please try again.',role:'assistant',timestamp:new Date()};setMessages(prev=>[...prev,errorMessage]);}finally{setIsLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col h-full\",children:[/*#__PURE__*/_jsx(ScrollArea,{ref:scrollAreaRef,className:\"flex-1\",children:/*#__PURE__*/_jsx(\"div\",{className:\"min-h-full\",children:messages.length===0&&!typingMessage?/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-full\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center max-w-md mx-auto px-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 mx-auto mb-4 bg-primary/10 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-2xl\",children:\"\\uD83E\\uDD16\"})}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold mb-2\",children:\"Welcome to Wexa Co-worker\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted-foreground mb-4\",children:\"I'm your AI co-worker powered by Wexa. Ask me anything about your knowledge base, and I'll process your queries through our intelligent pipeline.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-muted-foreground space-y-1\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\uD83D\\uDCA1 Try asking: \\\"Show me ATM configuration details for 2024\\\"\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\uD83D\\uDCCA Or: \\\"What are the latest software updates?\\\"\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\uD83D\\uDD0D Connected to Process Flow: \",sessionId.slice(0,8),\"...\"]})]})]})}):/*#__PURE__*/_jsxs(\"div\",{className:\"py-4\",children:[messages.map(message=>/*#__PURE__*/_jsx(MessageBubble,{message:message},message.id)),typingMessage&&/*#__PURE__*/_jsx(MessageBubble,{message:typingMessage,isTyping:true}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]})})}),/*#__PURE__*/_jsx(ChatInput,{onSendMessage:handleSendMessage,disabled:isLoading,placeholder:messages.length===0?\"Ask me anything about your knowledge base...\":\"Continue the conversation...\"})]});};","map":{"version":3,"names":["React","useState","useEffect","useRef","ScrollArea","MessageBubble","ChatInput","apiService","v4","uuidv4","jsx","_jsx","jsxs","_jsxs","ChatInterface","_ref","conversation","onConversationUpdate","userId","sessionId","messages","setMessages","isLoading","setIsLoading","typingMessage","setTypingMessage","scrollAreaRef","messagesEndRef","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","handleSendMessage","content","trim","userMessage","id","role","timestamp","Date","prev","typingMsg","console","log","queryRequest","user_id","session_id","query","response","sendQuery","assistantMessage","answer","sources","updatedConversation","_objectSpread","updated_at","error","errorMessage","className","children","ref","length","slice","map","message","isTyping","onSendMessage","disabled","placeholder"],"sources":["C:/Users/ashwi/OneDrive/Desktop/LightRiver UI/src/components/chat/ChatInterface.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { ScrollArea } from '../ui/scroll-area';\nimport { MessageBubble } from './MessageBubble';\nimport { ChatInput } from './ChatInput';\nimport { Message, QueryRequest, Conversation } from '../../types';\nimport { apiService } from '../../services/api';\nimport { v4 as uuidv4 } from 'uuid';\n\ninterface ChatInterfaceProps {\n  conversation?: Conversation;\n  onConversationUpdate: (conversation: Conversation) => void;\n  userId: string;\n  sessionId: string;\n}\n\nexport const ChatInterface: React.FC<ChatInterfaceProps> = ({\n  conversation,\n  onConversationUpdate,\n  userId,\n  sessionId\n}) => {\n  const [messages, setMessages] = useState<Message[]>(conversation?.messages || []);\n  const [isLoading, setIsLoading] = useState(false);\n  const [typingMessage, setTypingMessage] = useState<Message | null>(null);\n  const scrollAreaRef = useRef<HTMLDivElement>(null);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    if (conversation) {\n      setMessages(conversation.messages);\n    } else {\n      setMessages([]);\n    }\n  }, [conversation]);\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages, typingMessage]);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  const handleSendMessage = async (content: string) => {\n    if (!content.trim() || isLoading) return;\n\n    const userMessage: Message = {\n      id: uuidv4(),\n      content,\n      role: 'user',\n      timestamp: new Date(),\n    };\n\n    setMessages(prev => [...prev, userMessage]);\n    setIsLoading(true);\n\n    // Show typing indicator\n    const typingMsg: Message = {\n      id: 'typing',\n      content: '',\n      role: 'assistant',\n      timestamp: new Date(),\n    };\n    setTypingMessage(typingMsg);\n\n    try {\n      console.log('Sending query to Wexa co-worker:', content);\n      \n      const queryRequest: QueryRequest = {\n        user_id: userId,\n        session_id: sessionId,\n        query: content,\n      };\n\n      const response = await apiService.sendQuery(queryRequest);\n      console.log('Received response from Wexa co-worker:', response);\n\n      const assistantMessage: Message = {\n        id: uuidv4(),\n        content: response.answer,\n        role: 'assistant',\n        timestamp: new Date(),\n        sources: response.sources,\n      };\n\n      setTypingMessage(null);\n      setMessages(prev => [...prev, assistantMessage]);\n\n      // Update conversation\n      if (conversation) {\n        const updatedConversation: Conversation = {\n          ...conversation,\n          messages: [...conversation.messages, userMessage, assistantMessage],\n          updated_at: new Date(),\n        };\n        onConversationUpdate(updatedConversation);\n      }\n\n    } catch (error) {\n      console.error('Error sending message:', error);\n      setTypingMessage(null);\n      \n      const errorMessage: Message = {\n        id: uuidv4(),\n        content: 'Sorry, I encountered an error while processing your request. Please try again.',\n        role: 'assistant',\n        timestamp: new Date(),\n      };\n      \n      setMessages(prev => [...prev, errorMessage]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col h-full\">\n      {/* Messages Area */}\n      <ScrollArea ref={scrollAreaRef} className=\"flex-1\">\n        <div className=\"min-h-full\">\n          {messages.length === 0 && !typingMessage ? (\n            <div className=\"flex items-center justify-center h-full\">\n              <div className=\"text-center max-w-md mx-auto px-4\">\n                <div className=\"w-16 h-16 mx-auto mb-4 bg-primary/10 rounded-full flex items-center justify-center\">\n                  <span className=\"text-2xl\">ü§ñ</span>\n                </div>\n                <h2 className=\"text-xl font-semibold mb-2\">Welcome to Wexa Co-worker</h2>\n                <p className=\"text-muted-foreground mb-4\">\n                  I'm your AI co-worker powered by Wexa. Ask me anything about your knowledge base, \n                  and I'll process your queries through our intelligent pipeline.\n                </p>\n                <div className=\"text-sm text-muted-foreground space-y-1\">\n                  <p>üí° Try asking: \"Show me ATM configuration details for 2024\"</p>\n                  <p>üìä Or: \"What are the latest software updates?\"</p>\n                  <p>üîç Connected to Process Flow: {sessionId.slice(0, 8)}...</p>\n                </div>\n              </div>\n            </div>\n          ) : (\n            <div className=\"py-4\">\n              {messages.map((message) => (\n                <MessageBubble key={message.id} message={message} />\n              ))}\n              {typingMessage && (\n                <MessageBubble message={typingMessage} isTyping />\n              )}\n              <div ref={messagesEndRef} />\n            </div>\n          )}\n        </div>\n      </ScrollArea>\n\n      {/* Input Area */}\n      <ChatInput\n        onSendMessage={handleSendMessage}\n        disabled={isLoading}\n        placeholder={\n          messages.length === 0 \n            ? \"Ask me anything about your knowledge base...\" \n            : \"Continue the conversation...\"\n        }\n      />\n    </div>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}